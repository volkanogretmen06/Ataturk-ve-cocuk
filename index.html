<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AtatÃ¼rk ile YÃ¼z BirleÅŸtirici</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: "Poppins", sans-serif;
      background: radial-gradient(circle at top, #0a0a0a, #1e1e1e);
      color: white;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    h1 {
      margin-top: 20px;
      font-size: 1.8rem;
      color: #f4f4f4;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }
    .upload-section {
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
      margin-top: 20px;
    }
    .upload-box {
      background: #1e1e1e;
      border: 2px dashed #555;
      border-radius: 12px;
      padding: 15px;
      width: 260px;
      text-align: center;
    }
    .upload-box input {
      display: none;
    }
    .upload-box label {
      background: #0b3954;
      color: white;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      display: inline-block;
      margin-top: 8px;
    }
    img.preview {
      width: 100%;
      margin-top: 10px;
      border-radius: 8px;
      display: none;
    }
    canvas {
      border: 2px solid #555;
      border-radius: 12px;
      margin-top: 20px;
      background: #111;
      touch-action: none;
      width: 100%;
      max-width: 700px;
      height: auto;
    }
    select, button {
      margin: 10px;
      padding: 10px 15px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
    }
    button {
      background: #0b3954;
      color: white;
      transition: 0.3s;
    }
    button:hover {
      background: #124c73;
    }
    .footer {
      margin-top: 40px;
      padding: 20px;
      background: #0d0d0d;
      border-top: 1px solid #333;
      font-size: 0.95rem;
    }
    .footer a {
      color: #E1306C;
      text-decoration: none;
      font-weight: bold;
    }
    .footer img {
      width: 22px;
      height: 22px;
      vertical-align: middle;
      margin-right: 5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ–¼ï¸ AtatÃ¼rk ile YÃ¼z BirleÅŸtirici</h1>
    <p>AtatÃ¼rk'Ã¼n fotoÄŸrafÄ±yla kendi fotoÄŸrafÄ±nÄ±zÄ± birleÅŸtirip Ã¶zel bir portre oluÅŸturun.</p>

    <div class="upload-section">
      <div class="upload-box">
        <p><strong>1ï¸âƒ£ AtatÃ¼rk FotoÄŸrafÄ±</strong></p>
        <input type="file" id="ataturkUpload" accept="image/*">
        <label for="ataturkUpload">FotoÄŸraf YÃ¼kle</label>
        <img id="ataturkPreview" class="preview">
      </div>

      <div class="upload-box">
        <p><strong>2ï¸âƒ£ Kendi FotoÄŸrafÄ±n</strong></p>
        <input type="file" id="userUpload" accept="image/*">
        <label for="userUpload">FotoÄŸraf YÃ¼kle</label>
        <img id="userPreview" class="preview">
      </div>
    </div>

    <canvas id="previewCanvas" width="700" height="500"></canvas>

    <div>
      <label>ğŸ¨ Efekt:</label>
      <select id="effectSelect">
        <option value="none">Normal</option>
        <option value="bw">Siyah-Beyaz</option>
        <option value="sepia">Sepya</option>
        <option value="cold">SoÄŸuk Ton</option>
      </select>
    </div>

    <div>
      <button id="mergeButton">BirleÅŸtir</button>
      <button id="downloadButton" style="display:none;">Finali Ä°ndir</button>
      <select id="downloadQuality" style="padding:6px 8px;border-radius:8px;border:none;background:#0b3954;color:white">
        <option value="1">YÃ¼ksek Kalite</option>
        <option value="0.7">Orta Kalite</option>
        <option value="0.4">DÃ¼ÅŸÃ¼k Kalite</option>
      </select>
    </div>

    <div class="footer">
      <p>Bu proje, Ã¶ÄŸrenciler ve Ã¶ÄŸretmenler iÃ§in <strong>yaratÄ±cÄ± bir AtatÃ¼rk anÄ±sÄ±</strong> oluÅŸturmayÄ± amaÃ§lar.</p>
      <a href="https://www.instagram.com/volkanogretmn06" target="_blank" rel="noopener noreferrer">
        <img src="https://upload.wikimedia.org/wikipedia/commons/a/a5/Instagram_icon.png" alt="Instagram" />
        @volkanogretmn06
      </a>
      <div style="margin-top:6px;font-size:14px;color:#E1306C;font-weight:600">
        â†‘ Takip etmeyi unutmayÄ±n â¤ï¸ â†‘
      </div>
    </div>
  </div>

  <script>
  const canvas = document.getElementById("previewCanvas");
  const ctx = canvas.getContext("2d");

  const ataturkInput = document.getElementById("ataturkUpload");
  const userInput = document.getElementById("userUpload");
  const ataturkPreview = document.getElementById("ataturkPreview");
  const userPreview = document.getElementById("userPreview");
  const effectSelect = document.getElementById("effectSelect");
  const mergeButton = document.getElementById("mergeButton");
  const downloadButton = document.getElementById("downloadButton");
  const downloadQuality = document.getElementById("downloadQuality");

  let ataturkImg = new Image();
  let userImg = new Image();
  let ataturkPos = { x: 0, y: 0, scale: 1 };
  let userPos = { x: canvas.width / 2, y: 0, scale: 1 };
  let dragging = null;
  let mergedImage = null;

  function loadImage(event, imageObj, previewEl) {
    const file = event.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function (e) {
      imageObj.src = e.target.result;
      previewEl.src = e.target.result;
      previewEl.style.display = "block";
      drawCanvas();
    };
    reader.readAsDataURL(file);
  }

  ataturkInput.addEventListener("change", (e) => loadImage(e, ataturkImg, ataturkPreview));
  userInput.addEventListener("change", (e) => loadImage(e, userImg, userPreview));

  function drawCanvas() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    if (ataturkImg.src)
      ctx.drawImage(ataturkImg, ataturkPos.x, ataturkPos.y, ataturkImg.width * ataturkPos.scale, ataturkImg.height * ataturkPos.scale);
    if (userImg.src) {
      ctx.globalAlpha = 0.8;
      ctx.drawImage(userImg, userPos.x, userPos.y, userImg.width * userPos.scale, userImg.height * userPos.scale);
      ctx.globalAlpha = 1.0;
    }
  }

  let lastX, lastY;
  canvas.addEventListener("mousedown", (e) => {
    lastX = e.offsetX;
    lastY = e.offsetY;
    dragging = getActiveImage(e.offsetX, e.offsetY);
  });
  canvas.addEventListener("mousemove", (e) => {
    if (!dragging) return;
    const dx = e.offsetX - lastX;
    const dy = e.offsetY - lastY;
    lastX = e.offsetX;
    lastY = e.offsetY;
    dragging.x += dx;
    dragging.y += dy;
    drawCanvas();
  });
  canvas.addEventListener("mouseup", () => (dragging = null));
  canvas.addEventListener("wheel", (e) => {
    e.preventDefault();
    const zoom = e.deltaY < 0 ? 1.1 : 0.9;
    const active = getActiveImage(e.offsetX, e.offsetY);
    if (active) {
      active.scale *= zoom;
      drawCanvas();
    }
  });
  function getActiveImage() {
    if (userImg.src) return userPos;
    if (ataturkImg.src) return ataturkPos;
    return null;
  }

  mergeButton.addEventListener("click", () => {
    if (!ataturkImg.src || !userImg.src) {
      alert("LÃ¼tfen iki fotoÄŸraf da yÃ¼klensin.");
      return;
    }
    const tempCanvas = document.createElement("canvas");
    tempCanvas.width = canvas.width;
    tempCanvas.height = canvas.height;
    const tctx = tempCanvas.getContext("2d");
    tctx.drawImage(ataturkImg, ataturkPos.x, ataturkPos.y, ataturkImg.width * ataturkPos.scale, ataturkImg.height * ataturkPos.scale);
    tctx.save();
    tctx.beginPath();
    tctx.rect(canvas.width / 2, 0, canvas.width / 2, canvas.height);
    tctx.clip();
    tctx.drawImage(userImg, userPos.x, userPos.y, userImg.width * userPos.scale, userImg.height * userPos.scale);
    tctx.restore();
    applyEffect(tctx, tempCanvas, effectSelect.value);
    mergedImage = tempCanvas.toDataURL();
    downloadButton.style.display = "inline-block";
    ctx.drawImage(tempCanvas, 0, 0);
  });

  function applyEffect(ctx, canvas, type) {
    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    const data = imageData.data;
    for (let i = 0; i < data.length; i += 4) {
      let r = data[i], g = data[i + 1], b = data[i + 2];
      if (type === "bw") {
        const avg = (r + g + b) / 3;
        data[i] = data[i + 1] = data[i + 2] = avg;
      } else if (type === "sepia") {
        data[i] = r * 0.393 + g * 0.769 + b * 0.189;
        data[i + 1] = r * 0.349 + g * 0.686 + b * 0.168;
        data[i + 2] = r * 0.272 + g * 0.534 + b * 0.131;
      } else if (type === "cold") {
        data[i] = r * 0.8;
        data[i + 1] = g * 0.9;
        data[i + 2] = Math.min(b * 1.2, 255);
      }
    }
    ctx.putImageData(imageData, 0, 0);
  }

  downloadButton.addEventListener("click", () => {
    const quality = parseFloat(downloadQuality.value) || 1;
    const off = document.createElement("canvas");
    off.width = canvas.width;
    off.height = canvas.height;
    const octx = off.getContext("2d");
    drawCanvas();
    octx.drawImage(canvas, 0, 0);
    const link = document.createElement("a");
    link.download = "birlesik-yuz.png";
    link.href = off.toDataURL("image/png", quality);
    link.click();
  });
  </script>
</body>
</html>
