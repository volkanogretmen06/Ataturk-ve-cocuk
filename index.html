<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Atatürk ile Yüz Birleştirici</title>
  <style>
    body {
      font-family: "Poppins", sans-serif;
      background: radial-gradient(circle at top, #0a0a0a, #1e1e1e);
      color: white;
      text-align: center;
      margin: 0;
      padding: 20px;
    }
    h1 {
      color: #ffd700;
      margin-bottom: 20px;
    }
    .upload-area {
      display: flex;
      justify-content: center;
      gap: 20px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }
    .upload-box {
      background: #2a2a2a;
      padding: 10px;
      border-radius: 10px;
      width: 280px;
      text-align: center;
    }
    input[type="file"] {
      display: none;
    }
    label {
      display: inline-block;
      background: #444;
      padding: 8px 15px;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 8px;
    }
    .preview {
      margin-top: 10px;
      width: 100%;
      height: 280px;
      border-radius: 8px;
      overflow: hidden;
      background: #111;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }
    .preview img {
      max-width: 100%;
      max-height: 100%;
      transition: transform 0.3s ease, filter 0.3s ease;
    }
    .controls {
      margin-top: 10px;
      font-size: 14px;
    }
    .controls input {
      width: 80%;
    }
    #canvas-container {
      position: relative;
      margin-top: 30px;
    }
    #blendCanvas {
      max-width: 100%;
      border-radius: 10px;
      touch-action: none;
    }
    #downloadBtn {
      background: #ffd700;
      color: #000;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 15px;
    }
  </style>
</head>
<body>
  <h1>Atatürk ile Yüz Birleştirici</h1>
  <p>1️⃣ Atatürk fotoğrafını, 2️⃣ kendi fotoğrafını yükle. Efektleri uygula, yakınlaştır, hizala.</p>

  <div class="upload-area">
    <div class="upload-box">
      <h3>Atatürk Fotoğrafı</h3>
      <label for="atatürkInput">Fotoğraf Yükle</label>
      <input type="file" id="atatürkInput" accept="image/*" />
      <div class="preview"><img id="atatürkPreview" /></div>

      <div class="controls">
        <label>Renk Tonu</label><br>
        <input type="range" id="ataturkHue" min="0" max="360" value="0"><br>
        <label>Parlaklık</label><br>
        <input type="range" id="ataturkBrightness" min="50" max="150" value="100"><br>
        <label>Kontrast</label><br>
        <input type="range" id="ataturkContrast" min="50" max="150" value="100">
      </div>
    </div>

    <div class="upload-box">
      <h3>Kendi Fotoğrafın</h3>
      <label for="userInput">Fotoğraf Yükle</label>
      <input type="file" id="userInput" accept="image/*" />
      <div class="preview"><img id="userPreview" /></div>

      <div class="controls">
        <label>Renk Tonu</label><br>
        <input type="range" id="userHue" min="0" max="360" value="0"><br>
        <label>Parlaklık</label><br>
        <input type="range" id="userBrightness" min="50" max="150" value="100"><br>
        <label>Kontrast</label><br>
        <input type="range" id="userContrast" min="50" max="150" value="100">
      </div>
    </div>
  </div>

  <div id="canvas-container">
    <canvas id="blendCanvas" width="600" height="400"></canvas>
  </div>

  <button id="downloadBtn">Birleştirilen Görseli İndir</button>

  <script>
    const ataturkInput = document.getElementById("atatürkInput");
    const userInput = document.getElementById("userInput");
    const ataturkPreview = document.getElementById("atatürkPreview");
    const userPreview = document.getElementById("userPreview");
    const canvas = document.getElementById("blendCanvas");
    const ctx = canvas.getContext("2d");

    let ataturkImg = null, userImg = null, scale = 1, posX = 0, posY = 0;

    // Efekt ayarları
    function applyFilters() {
      ataturkPreview.style.filter = `
        hue-rotate(${ataturkHue.value}deg)
        brightness(${ataturkBrightness.value}%)
        contrast(${ataturkContrast.value}%)
      `;
      userPreview.style.filter = `
        hue-rotate(${userHue.value}deg)
        brightness(${userBrightness.value}%)
        contrast(${userContrast.value}%)
      `;
    }

    document.querySelectorAll("input[type='range']").forEach(slider => {
      slider.addEventListener("input", applyFilters);
    });

    // Görsel yükleme ve önizleme
    ataturkInput.onchange = e => loadPreview(e, ataturkPreview, img => ataturkImg = img);
    userInput.onchange = e => loadPreview(e, userPreview, img => userImg = img);

    function loadPreview(e, previewEl, callback) {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = ev => {
        previewEl.src = ev.target.result;
        const img = new Image();
        img.onload = () => callback(img);
        img.src = ev.target.result;
      };
      reader.readAsDataURL(file);
    }

    // Yakınlaştırma / Taşıma
    let isDragging = false, lastX, lastY;
    canvas.addEventListener("wheel", e => {
      e.preventDefault();
      scale += e.deltaY * -0.001;
      scale = Math.min(Math.max(0.5, scale), 3);
      draw();
    });
    canvas.addEventListener("mousedown", e => {
      isDragging = true;
      lastX = e.offsetX;
      lastY = e.offsetY;
    });
    canvas.addEventListener("mouseup", () => isDragging = false);
    canvas.addEventListener("mousemove", e => {
      if (!isDragging) return;
      posX += e.offsetX - lastX;
      posY += e.offsetY - lastY;
      lastX = e.offsetX;
      lastY = e.offsetY;
      draw();
    });

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      if (ataturkImg) {
        ctx.filter = `hue-rotate(${ataturkHue.value}deg) brightness(${ataturkBrightness.value}%) contrast(${ataturkContrast.value}%)`;
        ctx.drawImage(ataturkImg, 0, 0, canvas.width / 2, canvas.height);
      }
      if (userImg) {
        ctx.filter = `hue-rotate(${userHue.value}deg) brightness(${userBrightness.value}%) contrast(${userContrast.value}%)`;
        const w = canvas.width / 2 * scale;
        const h = canvas.height * scale;
        ctx.drawImage(userImg, canvas.width / 2 + posX, posY, w, h);
      }
      ctx.filter = "none";
    }

    document.getElementById("downloadBtn").onclick = () => {
      draw();
      const a = document.createElement("a");
      a.href = canvas.toDataURL("image/png");
      a.download = "birlesik-fotograf.png";
      a.click();
    };
  </script>
</body>
</html>
